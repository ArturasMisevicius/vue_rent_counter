# Security Configuration Template
# Copy relevant settings to your .env file

# ============================================================================
# CORE SECURITY SETTINGS
# ============================================================================

APP_DEBUG=false
APP_ENV=production
APP_URL=https://your-domain.com

# ============================================================================
# SESSION SECURITY
# ============================================================================

SESSION_DRIVER=database
SESSION_LIFETIME=120
SESSION_EXPIRE_ON_CLOSE=false
SESSION_ENCRYPT=true
SESSION_SECURE_COOKIE=true
SESSION_HTTP_ONLY=true
SESSION_SAME_SITE=lax
SESSION_PARTITIONED_COOKIE=false

# ============================================================================
# SECURITY HEADERS
# ============================================================================

SECURITY_X_FRAME_OPTIONS=DENY
SECURITY_X_CONTENT_TYPE_OPTIONS=nosniff
SECURITY_X_XSS_PROTECTION="1; mode=block"
SECURITY_REFERRER_POLICY=strict-origin-when-cross-origin
SECURITY_PERMISSIONS_POLICY="geolocation=(), microphone=(), camera=()"
SECURITY_HSTS="max-age=31536000; includeSubDomains; preload"

# ============================================================================
# CONTENT SECURITY POLICY
# ============================================================================

SECURITY_CSP_ENABLED=true
SECURITY_CSP_REPORT_ONLY=false
SECURITY_CSP_REPORT_URI=

# ============================================================================
# RATE LIMITING
# ============================================================================

SECURITY_ADMIN_MAX_ATTEMPTS=10
SECURITY_ADMIN_DECAY_SECONDS=300
SECURITY_API_MAX_ATTEMPTS=60
SECURITY_API_DECAY_SECONDS=60

# ============================================================================
# AUDIT LOGGING
# ============================================================================

SECURITY_AUDIT_LOGGING=true
SECURITY_AUDIT_CHANNEL=stack
SECURITY_MASK_PII_IN_LOGS=false
SECURITY_LOG_RETENTION_DAYS=90

# ============================================================================
# PII PROTECTION (GDPR Compliance)
# ============================================================================

SECURITY_MASK_EMAIL=false
SECURITY_MASK_IP=false
SECURITY_REDACT_USER_AGENT=false

# ============================================================================
# SESSION MANAGEMENT
# ============================================================================

SECURITY_REGENERATE_SESSION_ON_LOGIN=true
SECURITY_REGENERATE_ON_PRIVILEGE_CHANGE=true
SECURITY_SESSION_ABSOLUTE_TIMEOUT=28800

# ============================================================================
# DEMO MODE
# ============================================================================

SECURITY_DEMO_MODE=false
SECURITY_DEMO_ALLOW_READ=true
SECURITY_DEMO_ALLOW_WRITE=false

# ============================================================================
# MONITORING & ALERTING
# ============================================================================

SECURITY_ALERT_ON_AUTH_FAILURE=false
SECURITY_ALERT_THRESHOLD=10

# Sentry (optional)
SENTRY_LARAVEL_DSN=

# ============================================================================
# DATABASE SECURITY
# ============================================================================

DB_CONNECTION=mysql
DB_SSL_MODE=require
DB_SSL_CA=/path/to/ca-cert.pem

# ============================================================================
# CACHE & QUEUE SECURITY
# ============================================================================

CACHE_DRIVER=redis
QUEUE_CONNECTION=redis
REDIS_PASSWORD=your-strong-redis-password

# ============================================================================
# BACKUP SECURITY
# ============================================================================

BACKUP_ENCRYPTION_PASSWORD=your-strong-backup-password
BACKUP_RETENTION_DAYS=30

# ============================================================================
# AUTHENTICATION
# ============================================================================

AUTH_PASSWORD_TIMEOUT=10800
